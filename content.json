{"meta":{"title":"å°ç™½åŒå­¦çš„åšå®¢","subtitle":"","description":"æœ¬ç«™æ˜¯å°ç™½åŒå­¦æŠ€æœ¯åˆ†äº«åšå®¢","author":"å°ç™½åŒå­¦","url":"https://blog-wangyong.xyz","root":"/"},"pages":[{"title":"categories","date":"2020-12-29T13:42:15.427Z","updated":"2020-12-21T15:55:15.730Z","comments":true,"path":"categories/index.html","permalink":"https://blog-wangyong.xyz/categories/index.html","excerpt":"","text":""},{"title":"about","date":"2020-12-31T04:58:34.212Z","updated":"2020-12-31T04:58:34.212Z","comments":true,"path":"about/index.html","permalink":"https://blog-wangyong.xyz/about/index.html","excerpt":"","text":"ä¸&nbsp; å°ç™½åŒå­¦&nbsp; ï¼ˆ ï¼‰ é€šè¯ä¸­ï¼š å°ç™½åŒå­¦ğŸ·ğŸµğŸŸ GitHubï¼šLWANGYONG QQï¼š3285884651 å¾®ä¿¡ï¼šQQIDWeChat666"},{"title":"analytics","date":"2020-12-29T13:42:15.426Z","updated":"2020-12-28T15:36:41.812Z","comments":true,"path":"analytics/index.html","permalink":"https://blog-wangyong.xyz/analytics/index.html","excerpt":"","text":""},{"title":"friends","date":"2020-12-29T13:42:15.427Z","updated":"2020-12-21T15:58:44.478Z","comments":true,"path":"friends/index.html","permalink":"https://blog-wangyong.xyz/friends/index.html","excerpt":"","text":""},{"title":"links","date":"2021-01-08T15:04:56.000Z","updated":"2021-01-08T15:04:56.318Z","comments":true,"path":"links/index.html","permalink":"https://blog-wangyong.xyz/links/index.html","excerpt":"","text":""},{"title":"Gallery","date":"2020-12-29T13:42:15.428Z","updated":"2020-12-21T16:02:40.927Z","comments":true,"path":"photos/index.html","permalink":"https://blog-wangyong.xyz/photos/index.html","excerpt":"","text":""},{"title":"æ­Œå•","date":"2020-12-23T02:57:17.000Z","updated":"2020-12-29T03:40:07.732Z","comments":true,"path":"music/index.html","permalink":"https://blog-wangyong.xyz/music/index.html","excerpt":"","text":"initRunner('#container'); function cancelSpace(e){ var e = e|| window.event; var elm = e.srcElement || e.target; var key = e.keyCode || e.charCode; if(key == 32){ if(elm.tagName.toLowerCase()==\"input\" && elm.type.toLowerCase()==\"text\" || elm.tagName.toLowerCase() == \"textarea\"){ return; } if(window.event){ e.returnValue = false; } else{ e.preventDefault(); } } } document.onkeypress=cancelSpace; ğŸ‘‰é”®ç›˜ä¸Šâ€œç©ºæ ¼â€æˆ–â€œâ†‘é”®â€å¼€å§‹ğŸ®æ¸¸æˆï¼Œæ‰‹æœºç«¯ç‚¹ğŸ¦–ğŸ‘ˆï¼Œâ€œâ†‘é”®â€æˆ–â€œç©ºæ ¼â€è·³è·ƒï¼Œâ€œâ†“é”®â€è¶´ä¸‹ï¼Œæ¬¢è¿æˆç»©ç•™è¨€~(â—â€™â—¡â€™â—)~"},{"title":"tags","date":"2020-12-29T13:42:15.429Z","updated":"2020-12-21T15:57:57.074Z","comments":true,"path":"tags/index.html","permalink":"https://blog-wangyong.xyz/tags/index.html","excerpt":"","text":""},{"title":"shuoshuo","date":"2020-12-29T13:42:15.429Z","updated":"2020-12-28T15:25:56.216Z","comments":true,"path":"shuoshuo/index.html","permalink":"https://blog-wangyong.xyz/shuoshuo/index.html","excerpt":"","text":""}],"posts":[{"title":"æŠŠè‡ªå·±çš„ç½‘ç«™ä½œåº”ç”¨å®‰è£…åœ¨æµè§ˆå™¨ä¸­","slug":"æµè§ˆå™¨","date":"2021-01-11T13:53:17.498Z","updated":"2021-01-11T14:20:22.063Z","comments":true,"path":"article/ab1a0d15.html","link":"","permalink":"https://blog-wangyong.xyz/article/ab1a0d15.html","excerpt":"","text":"æˆ‘ä»¬æ¯æ¬¡å†™åšå®¢åéƒ½è¦æ‰“å¼€æµè§ˆå™¨çœ‹ä¸€ä¸‹ï¼Œæ˜¯å¦æœ‰é—®é¢˜ï¼Œè€Œä¸”æ¯æ¬¡éƒ½è¦åœ¨æµè§ˆå™¨ä¸­è¾“å…¥åŸŸåï¼Œæˆ‘æ„Ÿè§‰æ¯æ¬¡éƒ½æœ‰ç‚¹éº»çƒ¦ï¼Œå¦‚æœæŠŠç½‘ç«™ææˆä¸€ä¸ªè½¯ä»¶ï¼Œæ”¾åœ¨æ¡Œé¢å°±ä¸ç”¨æ¯æ¬¡éƒ½è¦æ‰“å¼€æµè§ˆå™¨äº†ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥åœ¨æ¡Œé¢æ”¾äº†é“¾æ¥ï¼Œä½†æ˜¯æ„Ÿè§‰é€¼æ ¼ä¸å¤Ÿï¼Œï¼ˆç”¨ä»£ç å†™çš„è¯åˆå¤šæ­¤ä¸€ä¸¾ï¼‰ã€‚ä»Šå¤©æˆ‘å‘Šè¯‰ä½ ä»¬ä¸€ä¸ªç®€å•çš„æ–¹æ³•ã€‚ é¦–å…ˆæˆ‘ä»¬æ‰“å¼€Microsoft Edgeï¼Œå¦‚ä¸‹å›¾ å®‰è£…å¥½ä¹‹å æˆ‘ä»¬å†æ‰“å¼€åº”ç”¨ ç„¶åå³é”®å›ºå®šåˆ°æ¡Œé¢","categories":[{"name":"ä¸ªäºº","slug":"ä¸ªäºº","permalink":"https://blog-wangyong.xyz/categories/%E4%B8%AA%E4%BA%BA/"}],"tags":[]},{"title":"å…¨ç½‘å¤‡ä»½è„šæœ¬","slug":"å…¨ç½‘å¤‡ä»½è„šæœ¬","date":"2021-01-11T13:05:21.141Z","updated":"2021-01-11T13:37:23.447Z","comments":true,"path":"article/86760658.html","link":"","permalink":"https://blog-wangyong.xyz/article/86760658.html","excerpt":"","text":"1ã€å®¢æˆ·ç«¯è„šæœ¬è¿™é‡Œæˆ‘æ‹¿nfsæœåŠ¡å™¨å……å½“å®¢æˆ·ç«¯ #/bin/bash Backup_dir=&quot;/backup&quot; IP_info=$(hostname -i) #cerate backup dir mkdir -p $Backup_dir/$IP_info #tar backup data cd / tar zchf $Backup_dir/$IP_info/system_backup_$(date +%F_week%w).tar.gz ./var/spool/cron/root ./etc/rc.local ./server/scripts ./etc/sysconfig/iptables #del 7 day ago data find $Backup_dir/ -type f -mtime +7|xargs rm 2&gt;/dev/null #create finger file find $Backup_dir/ -type f -mtime -1 ! -name &quot;finger*&quot;|xargs md5sum &gt;$Backup_dir/$Ip_info/finger.txt #backup push data info rsync -az $Backup_dir/ rsync_backup@172.16.1.41::backup --password-file=/etc/rsync.password 2ã€webæœåŠ¡å™¨è„šæœ¬#/bin/bash Backup_dir=&quot;/backup&quot; IP_info=$(hostname -i) #cerate backup dir mkdir -p $Backup_dir/$IP_info #tar backup data cd / tar zchf $Backup_dir/$IP_info/system_backup_$(date +%F_week%w).tar.gz ./var/spool/cron/root ./etc/rc.local ./server/scripts ./etc/sysconfig/iptables #tar zchf $Backup_dir/$IP_info/www_backup_$(data +%F_week%w).tar.gz ./var/html/www #tar zchf $Backup_dir/$IP_info/www_log_backup_$(data +%F_week%w).tar.gz ./app/logs tar zchf $Backup_dir/$IP_info/www_backup_$(date +%F_week%w).tar.gz ./var/html/www tar zchf $Backup_dir/$IP_info/www_log_backup_$(date +%F_week%w).tar.gz ./app/logs #del 7 day ago data find $Backup_dir/ -type f -mtime +7|xargs rm 2&gt;/dev/null #create finger file find $Backup_dir/ -type f -mtime -1 ! -name &quot;finger*&quot;|xargs md5sum &gt;$Backup_dir/$Ip_info/finger.txt #backup push data info #rsync -az $Backup_dir/ rsync_backup@172.16.1.41::backup --password-file=/etc/rsync.password rsync -az $Backup_dir/ rsync_backup@172.16.1.41::backup --password-file=/etc/rsync.password 3ã€å¤‡ä»½æœåŠ¡å™¨è„šæœ¬#del 180 day ago data find /backup/ -type f -mtime +180 ! -name &quot;week1.tar.gz&quot;|xargs rm 2 &gt;/dev/null #check backup data find /backup/ -type f -name &quot;fingex.txt&quot;|xargs md5sum -c &gt;/tmp/check.txt #sed check mail mail -s &quot;check info $(date +%F)&quot; 3285884651@qq.com &lt;/tmp/check.txt 4ã€å®ç°è‡ªåŠ¨å®Œæˆå…¨ç½‘æ•°æ®å¤‡ä»½ï¼ˆå®šæ—¶ä»»åŠ¡ï¼‰å®¢æˆ·ç«¯å®šæ—¶ä»»åŠ¡: crontab -e # backup data 0 0 * * * /bin/sh /server/scripts/backup.sh &amp;&gt;/dev/null æœåŠ¡ç«¯å®šæ—¶ä»»åŠ¡ # check backup data 0 5 * * * /bin/sh /server/scripts/backup_server.sh &amp;&gt;/dev/null å½“ç„¶è¿™äº›è¿˜æ˜¯æœ‰å®Œå–„çš„åœ°æ–¹","categories":[],"tags":[{"name":"çŸ¥è¯†ç‚¹","slug":"çŸ¥è¯†ç‚¹","permalink":"https://blog-wangyong.xyz/tags/%E7%9F%A5%E8%AF%86%E7%82%B9/"}]},{"title":"LINUXè¿ç»´å­¦ä¹ ä¹‹ç»¼åˆæ¶æ„ç¯‡â€”â€”å¤‡ä»½æœåŠ¡å™¨æ­å»º","slug":"å¤‡ä»½æœåŠ¡å™¨æ­å»º","date":"2021-01-08T15:07:31.000Z","updated":"2021-01-09T14:59:39.050Z","comments":true,"path":"article/22885f4a.html","link":"","permalink":"https://blog-wangyong.xyz/article/22885f4a.html","excerpt":"","text":"1ã€ä¸ŠæœŸæˆ‘ä»¬è®²äº†ç¯å¢ƒæ­å»ºï¼Œè¿™æ¬¡æˆ‘ä»¬æ­å»ºå¤‡ä»½æœåŠ¡å™¨é¦–å…ˆæˆ‘ä»¬å…ˆå…‹éš†ä¸»æœºï¼Œè¿™ä¸ªæˆ‘å°±ä¸æ¼”ç¤ºåœ¨VMwareä¸­å…‹éš†é€‰æ‹©é“¾æ¥å…‹éš†ï¼ˆå­¦ä¹ ç¯å¢ƒï¼‰,å…‹éš†å¥½ä¹‹åè¿›è¡Œä¸»æœºé…ç½® aã€ä¿®æ”¹ä¸»æœºåhostnamectl set-hostname backup bã€ä¿®æ”¹IPåœ°å€grep 200 /etc/sysconfig/network-scripts/ifcfg-eth[01] #å…ˆæ‰¾å‡ºè¦ä¿®æ”¹çš„IPåœ°å€ sed -i &#39;s#200#41#g&#39; /etc/sysconfig/network-scripts/ifcfg-eth[01] #ç„¶åä¿®æ”¹ä¸¤å¼ ç½‘å¡ sed -i &#39;/UUID/d&#39; /etc/sysconfig/network-scripts/ifcfg-eth[01] #ç„¶ååœ¨åˆ é™¤UUIDçš„ä¿¡æ¯ PS: æœåŠ¡å™¨è¦ä¸€å°ä¸€å°çš„å¼€å¯ï¼Œè¿›è¡Œä¿®æ”¹ï¼Œä¸è¦åŒæ—¶å¯åŠ¨ å¤‡ä»½æœåŠ¡å™¨çš„ä½œç”¨ 01ã€å¤‡ä»½æ•°æ® 02ã€è¿›è¡Œæ—¥å¿—ç»Ÿä¸€ä¿å­˜ 2ã€å¦‚ä½•éƒ¨ç½²æ­å»ºå¤‡ä»½æœåŠ¡å™¨ï¼šrsyncæœåŠ¡01ã€ä»€ä¹ˆæ˜¯rsyncæœåŠ¡ï¼šrsyncæ˜¯ä¸€æ¬¾å¼€æºçš„ã€å¿«é€Ÿçš„ã€å¤šåŠŸèƒ½çš„å¯å®ç°çš„å…¨é‡åŠå¢é‡çš„æœ¬åœ°æˆ–è€…è¿œç¨‹æ•°æ®åŒæ­¥å¤‡ä»½çš„ä¼˜ç§€å·¥å…·ã€‚ aã€æœ¬åœ°å¤‡ä»½çš„å‘½ä»¤ cp /etc/hosts /etc/hosts.bak rsync /etc/hosts /tmp/hosts_rsync bã€ è¿œç¨‹å¤‡ä»½ scp è¿œç¨‹å¤‡ä»½çš„æ•°æ®é¦–å…ˆè¦æœ‰ä¸ªå¤‡ä»½ç›®å½• åœ¨å¤‡ä»½æœåŠ¡å™¨åˆ›å»ºä¸€ä¸ªbackupçš„ç›®å½• mkdir /backup scp -rp /etc/hosts root@172.16.1.41:/backup -r é€’å½’å¤åˆ¶ä¼ è¾“æ•°æ® -p ä¿æŒæ–‡ä»¶å±æ€§ 02ã€rsyncæ–¹å¼å¤‡ä»½æ•°æ®å…ˆå®‰è£…è½¯ä»¶ yum install -y rsync è¿™é‡Œæˆ‘æŠŠå­˜å‚¨æœåŠ¡å™¨å…ˆå½“ä½œå®¢æˆ·ç«¯ï¼ŒæœåŠ¡å™¨åå­—ä¸ºnfs01,å…¶ä»–ä¿®æ”¹å’Œå¤‡ä»½æœåŠ¡å™¨ä¸€æ ·,ä¹‹å‰æˆ‘åœ¨é‡Œé¢æäº†ä¸€ä¸‹ä¸œè¥¿ï¼Œç°åœ¨è¿™ä¸ªç›®å½•é‡Œæ˜¯æ²¡æœ‰hosts_rsyncæ–‡ä»¶çš„ æˆ‘ä»¬å…ˆæŸ¥çœ‹ä¸€ä¸‹å¤‡ä»½æœåŠ¡å™¨backupç›®å½• rsync -rp /etc/hosts 172.16.1.41:/backup/hosts_rsync æ­¤æ—¶å¤‡ä»½æœåŠ¡å™¨å°±å·²ç»æœ‰äº† æ€»ç»“ï¼šç”¨rsyncå¤‡ä»½ç›®å½•æ—¶ï¼š å¤‡ä»½ç›®å½•åé¢æœ‰ / åªè®²ç›®å½•ä¸‹é¢çš„å†…å®¹å¤‡ä»½ å¤‡ä»½ç›®å½•æ—¶åé¢æ²¡æœ‰ / åªå¤‡ä»½ç›®å½• 2ã€å®ˆæŠ¤è¿›ç¨‹æ–¹å¼å¤‡ä»½æ•°æ®01ã€å¯ä»¥è¿›è¡Œä¸€äº›å¤‡æ³¨ç®¡ç† 02ã€å¯ä»¥è¿›è¡Œå®‰å…¨ç­–ç•¥ç®¡ç† 03ã€å¯ä»¥å®ç°è‡ªåŠ¨ä¼ è¾“å¤‡ä»½æ•°æ® 1ã€rsync å®ˆæŠ¤è¿›ç¨‹éƒ¨ç½²æ–¹å¼ï¼›ï¼ˆæœåŠ¡ç«¯ï¼‰ï¼ˆ1ï¼‰ä¸‹è½½è½¯ä»¶ yum install -y rsync ï¼ˆ2ï¼‰é…ç½®æ–‡ä»¶ vim /etc/rsyncd.conf æŠŠä¸‹é¢æ·»åŠ è¿›å» ##created by HQ at 2017 ###rsyncd.conf start## uid = rsync --- æŒ‡å®šç®¡ç†å¤‡ä»½ç›®å½•çš„ç”¨æˆ· gid = rsync --- æŒ‡å®šç®¡ç†å¤‡ä»½ç›®å½•çš„ç”¨æˆ·ç»„ port = 873 --- å®šä¹‰rsyncå¤‡ä»½æœåŠ¡çš„ç½‘ç»œç«¯å£å· fake super = yes --- å°†rsyncè™šæ‹Ÿç”¨æˆ·ä¼ªè£…æˆä¸ºä¸€ä¸ªè¶…çº§ç®¡ç†å‘˜ç”¨æˆ· use chroot = no --- å’Œå®‰å…¨ç›¸å…³çš„é…ç½® max connections = 200 --- æœ€å¤§è¿æ¥æ•° åŒæ—¶åªèƒ½æœ‰200ä¸ªå®¢æˆ·ç«¯è¿æ¥åˆ°å¤‡ä»½æœåŠ¡å™¨ timeout = 300 --- è¶…æ—¶æ—¶é—´(å•ä½ç§’) pid file = /var/run/rsyncd.pid --- è®°å½•è¿›ç¨‹å·ç ä¿¡æ¯ 1.è®©ç¨‹åºå¿«é€Ÿåœæ­¢è¿›ç¨‹ 2. åˆ¤æ–­ä¸€ä¸ªæœåŠ¡æ˜¯å¦æ­£åœ¨è¿è¡Œ lock file = /var/run/rsync.lock --- é”æ–‡ä»¶ log file = /var/log/rsyncd.log --- rsyncæœåŠ¡çš„æ—¥å¿—æ–‡ä»¶ ç”¨äºæ’é”™åˆ†æé—®é¢˜ ignore errors --- å¿½ç•¥ä¼ è¾“ä¸­çš„ç®€å•é”™è¯¯ read only = false --- æŒ‡å®šå¤‡ä»½ç›®å½•æ˜¯å¯è¯»å¯å†™ list = false --- ä½¿å®¢æˆ·ç«¯å¯ä»¥æŸ¥çœ‹æœåŠ¡ç«¯çš„æ¨¡å—ä¿¡æ¯ hosts allow = 172.16.1.0/24 --- å…è®¸ä¼ è¾“å¤‡ä»½æ•°æ®çš„ä¸»æœº(ç™½åå•) hosts deny = 0.0.0.0/32 --- ç¦æ­¢ä¼ è¾“å¤‡ä»½æ•°æ®çš„ä¸»æœº(é»‘åå•) auth users = rsync_backup --- æŒ‡å®šè®¤è¯ç”¨æˆ· secrets file = /etc/rsync.password --- æŒ‡å®šè®¤è¯ç”¨æˆ·å¯†ç æ–‡ä»¶ ç”¨æˆ·åç§°:å¯†ç ä¿¡æ¯ [backup] --- æ¨¡å—ä¿¡æ¯ comment = &quot;backup dir by oldboy&quot; path = /backup --- æ¨¡å—ä¸­é…ç½®å‚æ•° æŒ‡å®šå¤‡ä»½ç›®å½• ï¼ˆ3ï¼‰åˆ›å»ºè™šæ‹Ÿç”¨æˆ·ï¼ˆrsyncï¼‰ useradd rsync -M -s /sbin/nologin ï¼ˆ4ï¼‰åˆ›å»ºå¤‡ä»½æœåŠ¡å™¨è®¤è¯å¯†ç æ–‡ä»¶ echo &quot;rsync_backup:123456&quot; &gt;/etc/rsync.password cat /etc/rsync.password #æŸ¥çœ‹ä¸€ä¸‹ chmod 600 /etc/rsync.passwod #è®¾ç½®æƒé™ ï¼ˆ5ï¼‰åˆ›å»ºå¤‡ä»½ç›®å½• mkdir /backup chown rsync.rsync /backup #ä¿®æ”¹ç”¨æˆ·ä¸»å’Œç”¨æˆ·ç»„ ï¼ˆ6ï¼‰å¯åŠ¨å¤‡ä»½æœåŠ¡å™¨ systemctl start rsyncd #å¯åŠ¨rsyncæœåŠ¡ systemctl enable rsyncd #è®¾ç½®å¼€æœºè‡ªå¯ systemctl status rsyncd #æŸ¥çœ‹çŠ¶æ€ 2ã€rsyncå®ˆæŠ¤è¿›ç¨‹å®¢æˆ·ç«¯éƒ¨ç½²ï¼ˆ1ï¼‰åˆ›å»ºä¸€ä¸ªå¯†ç ä¿¡æ¯ echo &quot;123456&quot; &gt;/etc/rsync.password #æ·»åŠ å¯†ç ä¿¡æ¯ chmod 600 /etc/rsync.password #ä¿®æ”¹æƒé™ ï¼ˆ2ï¼‰è¿›è¡Œå…äº¤äº’å¼ä¼ è¾“æ•°æ®æµ‹è¯• rsync -avz /etc/hosts rsync_backup@172.16.1.41::backup --password-file=/etc/rsync.password ï¼ˆ3ï¼‰æ¢å¤æ•°æ® rsync -avz root@172.16.1.41:/backup/hosts ./--password-file=/etc/rsync.password rsyncå‘½ä»¤å‚æ•°è¯´æ˜ -v æ˜¾ç¤ºè¯¦ç»†çš„ä¼ è¾“ä¿¡æ¯ -a å‘½ä»¤çš„å½’æ¡£å‚æ•° -r é€’å½’å‚æ•° -t ä¿æŒæ–‡ä»¶å±æ€§ï¼Œä¿®æ”¹æ—¶é—´ä¿¡æ¯ä¸å˜ -o ä¿æŒæ–‡ä»¶å±ä¸»ä¸å˜ -g ä¿æŒæ–‡ä»¶çš„å±ç»„ä¸å˜ PSï¼šå¦‚ä½•è®©-oå’Œ-gå‚æ•°ç”Ÿæ•ˆï¼Œéœ€è¦å°†é…ç½®æ–‡ä»¶rsyncd.confä¸­çš„uidå’Œgidæ”¹ä¸ºrootï¼ŒæŠŠfake superå‚æ•°è¿›è¡Œæ³¨é‡Š -p ä¿æŒæ–‡ä»¶æƒé™ä¿¡æ¯ä¸å˜ -D ä¿æŒè®¾å¤‡æ–‡ä»¶ä¿¡æ¯ä¸å˜ -l ä¿æŒé“¾æ¥æ–‡ä»¶å±æ€§ä¿¡æ¯ä¸å˜ -L ä¿æŒé“¾æ¥æ–‡ä»¶æ•°æ®ä¿¡æ¯ä¸å˜ -P æ˜¾ç¤ºæ•°æ®ä¼ è¾“çš„è¿›åº¦ä¿¡æ¯ --exclude=PATTERN æ’é™¤æŒ‡å®šæ•°æ®ä¸è¢«ä¼ è¾“ --exclude-from=file æ’é™¤æŒ‡å®šæ•°æ®ä¸è¢«ä¼ è¾“ï¼ˆæ‰¹é‡æ’é™¤ï¼‰ --bwlimit=RATE æ˜¾ç¤ºä¼ è¾“é€Ÿç‡ --delete æ— å·®å¼‚åŒæ­¥å‚æ•°","categories":[],"tags":[{"name":"ç»¼åˆæ¶æ„","slug":"ç»¼åˆæ¶æ„","permalink":"https://blog-wangyong.xyz/tags/%E7%BB%BC%E5%90%88%E6%9E%B6%E6%9E%84/"}]},{"title":"å®ˆæŠ¤è¿›ç¨‹æœåŠ¡åœ¨ä¼ä¸šåº”ç”¨","slug":"å®ˆæŠ¤è¿›ç¨‹æœåŠ¡åœ¨ä¼ä¸šåº”ç”¨","date":"2021-01-08T15:07:31.000Z","updated":"2021-01-09T15:01:31.248Z","comments":true,"path":"article/22885f4a.html","link":"","permalink":"https://blog-wangyong.xyz/article/22885f4a.html","excerpt":"","text":"1ã€å®ˆæŠ¤è¿›ç¨‹å¤šæ¨¡å—åŠŸèƒ½é…ç½®sa sa_data.txt dev dev_data.txt dba dba_data.txt vim /etc/rsync.conf #æ·»åŠ ä»¥ä¸‹ä¿¡æ¯ [backup] comment = &quot;backup dir by oldboy&quot; path = /backup [dba] comment = &quot;backup dir by oldboy&quot; path = /dba [dev] comment = &quot;backup dir by oldboy&quot; path = /devdata 2ã€å®ˆæŠ¤è¿›ç¨‹çš„æ’é™¤ç¯å¢ƒ[root@nfs01 /]# mkdir -p /oldboy [root@nfs01 /]# mkdir -p /oldboy/&#123;a..c&#125; [root@nfs01 /]# touch /oldboy/&#123;a..c&#125;/&#123;1..3&#125;.txt [root@nfs01 /]# tree /oldboy /oldboy â”œâ”€â”€ 01.txt â”œâ”€â”€ 02.txt â”œâ”€â”€ a â”‚?? â”œâ”€â”€ 1.txt â”‚?? â”œâ”€â”€ 2.txt â”‚?? â””â”€â”€ 3.txt â”œâ”€â”€ b â”‚?? â”œâ”€â”€ 1.txt â”‚?? â”œâ”€â”€ 2.txt â”‚?? â””â”€â”€ 3.txt â””â”€â”€ c â”œâ”€â”€ 1.txt â”œâ”€â”€ 2.txt â””â”€â”€ 3.txt 01ã€ éœ€æ±‚01: å°†/oldboyç›®å½•ä¸‹é¢ aç›®å½•æ•°æ®å…¨éƒ¨å¤‡ä»½ bç›®å½•ä¸è¦å¤‡ä»½1.txtæ–‡ä»¶ cæ•´ä¸ªç›®å½•ä¸è¦åšå¤‡ä»½--exclude=PATTERN ç»å¯¹è·¯å¾„æ–¹å¼: [root@nfs01 /]# rsync -avz /oldboy --exclude=/oldboy/b/1.txt --exclude=/oldboy/c/rsync_backup@172.16.1.41::backup --password-file=/etc/rsync.password sending incremental file list oldboy/ oldboy/01.txt oldboy/02.txt oldboy/a/ oldboy/a/1.txt oldboy/a/2.txt oldboy/a/3.txt oldboy/b/ oldboy/b/2.txt oldboy/b/3.txt ç›¸å¯¹è·¯å¾„æ–¹å¼: [root@nfs01 /]# rsync -avz /oldboy --exclude=b/1.txt --exclude=c/ rsync_backup@172.16.1.41::backup --password-file=/etc/rsync.password sending incremental file list oldboy/ oldboy/01.txt oldboy/02.txt oldboy/a/ oldboy/a/1.txt oldboy/a/2.txt oldboy/a/3.txt oldboy/b/ oldboy/b/2.txt oldboy/b/3.txt â€‹ sent 502 bytes received 177 bytes 1,358.00 bytes/sec total size is 0 speedup is 0.00 02ã€å°†/oldboyç›®å½•ä¸‹é¢ aç›®å½•æ•°æ®å…¨éƒ¨å¤‡ä»½ bç›®å½•ä¸è¦å¤‡ä»½1.txtæ–‡ä»¶ cæ•´ä¸ªç›®å½•1.txt 3.txtæ–‡ä»¶ä¸è¦å¤‡ä»½--exclude-from=file --- æ‰¹é‡æ’é™¤ ç¬¬ä¸€ä¸ªå†ç¨‹: ç¼–è¾‘å¥½ä¸€ä¸ªæ’é™¤æ–‡ä»¶ [root@nfs01 /]# cat /oldboy/exclude.txt b/1.txt c/1.txt c/3.txt exclude.txt ç¬¬äºŒä¸ªå†ç¨‹: å®ç°æ‰¹é‡æ’é™¤åŠŸèƒ½ [root@nfs01 /]# rsync -avz /oldboy --exclude-from=/oldboy/exclude.txt rsync_backup@172.16.1.41::backup --password-file=/etc/rsync.password sending incremental file list oldboy/ oldboy/01.txt oldboy/02.txt oldboy/a/ oldboy/a/1.txt oldboy/a/2.txt oldboy/a/3.txt oldboy/b/ oldboy/b/2.txt oldboy/b/3.txt oldboy/c/ oldboy/c/2.txt 03ã€å®ˆæŠ¤è¿›ç¨‹æ¥åˆ›å»ºå¤‡ä»½ç›®å½•[root@nfs01 /]# rsync -avz /etc/hosts rsync_backup@172.16.1.41::backup/10.0.0.31/ --password-file=/etc/rsync.password sending incremental file list created directory 10.0.0.31 hosts sent 226 bytes received 75 bytes 602.00 bytes/sec total size is 371 speedup is 1.23 PS: å®¢æˆ·ç«¯æ— æ³•åœ¨æœåŠ¡ç«¯åˆ›å»ºå¤šçº§ç›®å½• 3ã€ å®ˆæŠ¤è¿›ç¨‹çš„è®¿é—®æ§åˆ¶é…ç½®å®ˆæŠ¤è¿›ç¨‹ç™½åå•å’Œé»‘åå•åŠŸèƒ½PS: å»ºè®®åªä½¿ç”¨ä¸€ç§åå• å®ˆæŠ¤è¿›ç¨‹çš„åˆ—è¡¨åŠŸèƒ½é…ç½® [root@nfs01 /]# rsync rsync_backup@172.16.1.41:: backup &quot;backup dir by oldboy&quot; dba &quot;backup dir by oldboy&quot; dev &quot;backup dir by oldboy&quot;","categories":[],"tags":[{"name":"ä¼ä¸šä¸­çš„åº”ç”¨","slug":"ä¼ä¸šä¸­çš„åº”ç”¨","permalink":"https://blog-wangyong.xyz/tags/%E4%BC%81%E4%B8%9A%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/"}]},{"title":"å¤‡ä»½æœåŠ¡å™¨é¡¹ç›®éœ€æ±‚","slug":"å¤‡ä»½æœåŠ¡å™¨é¡¹ç›®éœ€æ±‚","date":"2021-01-08T15:07:31.000Z","updated":"2021-01-11T13:37:30.219Z","comments":true,"path":"article/87041637.html","link":"","permalink":"https://blog-wangyong.xyz/article/87041637.html","excerpt":"","text":"1ã€å¤‡ä»½é¡¹ç›®éœ€æ±‚ï¼ˆ1ï¼‰æ‰€æœ‰çš„æœåŠ¡å™¨å¤‡ä»½ç›®å½•ç»Ÿä¸€ï¼ˆ/backupï¼‰mkdir /backup ï¼ˆ2ï¼‰è¦å¤‡ä»½çš„ç³»ç»Ÿé…ç½®æ–‡ä»¶åŒ…æ‹¬ä½†ä¸é™äºï¼šâ€‹ aã€å®šæ—¶ä»»åŠ¡çš„é…ç½®æ–‡ä»¶ï¼ˆ/var/spool/cron/rootï¼‰ï¼ˆé€‚ç”¨äºwebå’ŒnfsæœåŠ¡å™¨ï¼‰ â€‹ bã€å¼€æœºè‡ªå¯åŠ¨çš„é…ç½®æ–‡ä»¶ï¼ˆ/etc/rc.localï¼‰ï¼ˆé€‚ç”¨äºwebå’ŒnfsæœåŠ¡å™¨ï¼‰ â€‹ cã€æ—¥å¸¸è„šæœ¬ç›®å½•ï¼ˆ/server/scriptsï¼‰ â€‹ dã€é˜²ç«å¢™iptablesçš„é…ç½®æ–‡ä»¶ï¼ˆ/etc/sysconfig/iptablesï¼‰ â€‹ eã€ç­‰ç­‰ tar zcvhf /backup/system_back.tar.gz /var/spool/cron/root /etc/rc.local /server/scripts /etc/sysconfig/iptables -h å°†é“¾æ¥æ–‡ä»¶æŒ‡å‘çš„æºæ–‡ä»¶å¤‡ä»½ PSï¼šæœ€å¥½ç”¨ç›¸å¯¹è·¯å¾„è¿›è¡Œå¤‡ä»½ cd / tar zcvhf /backup/system_back.tar.gz ./var/spool/cron/root ./etc/rc.local ./server/scripts ./etc/sysconfig/iptables ï¼ˆ3ï¼‰webæœåŠ¡å™¨ç«™ç‚¹ç›®å½•å‡å®šä¸ºï¼ˆ/var/html/wwwï¼‰tar zcvhf /backup/www_back.tar.gz ./var/html/www ï¼ˆ4ï¼‰webæœåŠ¡å™¨Aè®¿é—®æ—¥å¿—è·¯å¾„å‡å®šä¸ºï¼ˆ/app/logsï¼‰tar zcvhf /backup/www_log_back.tar.gz ./app/logs ï¼ˆ5ï¼‰webæœåŠ¡å™¨ä¿ç•™æ‰“åŒ…åä¸ƒå¤©çš„å¤‡ä»½æ•°æ®å³å¯ï¼ˆæœ¬åœ°ç•™å­˜7å¤©å³å¯ï¼Œå¤ªå¤šç¡¬ç›˜ä¼šæ»¡ï¼‰tar zchf /backup/system_backup_$(date +%F).tar.gz ./var/spool/cron/root ./etc/rc.local ./server/scripts ./etc/sysconfig/iptables find /backup -type f -mtime +7|xargs rm ï¼ˆ6ï¼‰å¤‡ä»½æœåŠ¡å™¨ä¸Šï¼Œä¿ç•™æ¯ä¸€å‘¨çš„æ‰€æœ‰æ•°æ®å‰¯æœ¬ï¼Œå…¶ä»–è¦ä¿ç•™6ä¸ªæœˆçš„æ•°æ®å‰¯æœ¬tar zchf /backup/www_backup_$(date +%F_week%w).tar.gz ./var/html/www tar zchf /backup/www_log_backup_$(date +%F_week%w).tar.gz ./app/logs find /backup -type f -mtime +180!-name &quot;*week1.tar.gz&quot;|xargs rm 2ã€å¦‚ä½•éªŒè¯æ•°æ®å®Œæ•´æ€§â€‹ åˆ©ç”¨md5ç®—æ³•è¿›è¡ŒéªŒè¯æ•°æ®å®Œæ•´æ€§â€‹ md5sum -c æŒ‡çº¹æ–‡ä»¶å‘½ä»¤æ‰§è¡ŒåŸç†â€‹ ç¬¬ä¸€ä¸ªå†ç¨‹: æ‰“å¼€ä¸€ä¸ªæŒ‡çº¹æ–‡ä»¶,å°†ä¿¡æ¯è®°å½•åˆ°ç¼“å­˜ä¸­â€‹ ç¬¬äºŒä¸ªå†ç¨‹: æ ¹æ®æŒ‡çº¹æ–‡ä»¶çš„è·¯å¾„ä¿¡æ¯,ç”Ÿæˆmd5æ•°å€¼ä¿¡æ¯â€‹ ç¬¬ä¸‰ä¸ªå†ç¨‹: å°†æ–°ç”Ÿæˆmd5æ•°å€¼å’ŒåŸæœ‰æŒ‡çº¹æ–‡ä»¶ä¸­çš„æ•°å€¼è¿›è¡Œæ¯”è¾ƒâ€‹ ç¬¬å››ä¸ªå†ç¨‹: å¦‚æœç›¸åŒæ˜¾ç¤ºç»“æœä¸ºok,å¦‚æœä¸åŒæ˜¾ç¤ºfailed find /backup/ -type f -mtime -1 ! -name &quot;finger*&quot; |xargs md5sum &gt;/backup/10.0.0.31/finger.txt rsync -avz /backup/rsync_backup@172.16.1.41::backup --password-file=/etc/rsync.password md5sum -c /backup/10.0.0.31/finger.txt #æ£€æŸ¥ 3ã€å¦‚ä½•å®ç°å‘é€é‚®ä»¶aã€é…ç½®163ä¼ä¸šé‚®ç®±æ³¨å†Œåé‚®ç®±æ‰“å¼€è®¾ç½® ä»¥ä¸‹é…ç½® bã€ç¼–å†™linuxæœåŠ¡é‚®ä»¶ç›¸å…³é…ç½®æ–‡ä»¶vim /etc/mail.rc set from=xxxx@163.com smtp=smtp.163.com set smtp-auth-user=xxxx@163.com smtp-auth-password=æˆæƒå¯†ç  smtp-auth=login systemctl restart postfix.service cã€ å‘é€é‚®ä»¶æµ‹è¯•echo &quot;é‚®ä»¶å‘é€æµ‹è¯•&quot;|mail -s &quot;é‚®ä»¶æµ‹è¯•&quot; xxxx@qq.com mail -s &quot;é‚®ä»¶æµ‹è¯•&quot; xxxxx@qq.com &lt;/etc/hosts é…ç½®å®Œæˆ","categories":[],"tags":[{"name":"ä¼ä¸šä¸­çš„åº”ç”¨","slug":"ä¼ä¸šä¸­çš„åº”ç”¨","permalink":"https://blog-wangyong.xyz/tags/%E4%BC%81%E4%B8%9A%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/"}]},{"title":"LINUXè¿ç»´å­¦ä¹ ä¹‹ç»¼åˆæ¶æ„ç¯‡â€”â€”æ¶æ„æ­å»ºå‡†å¤‡","slug":"ç»¼åˆæ¶æ„","date":"2020-12-28T12:08:59.000Z","updated":"2021-01-12T13:39:41.969Z","comments":true,"path":"article/f439b05e.html","link":"","permalink":"https://blog-wangyong.xyz/article/f439b05e.html","excerpt":"","text":"1ã€ç»¼åˆæ¶æ„ç»„æˆè¯´æ˜ç”¨æˆ·è®¿é—®ç½‘ç«™æ˜¯ä½¿ç”¨HTTPåè®®80ç«¯å£ï¼ŒæŸ¥çœ‹80ç«¯å£æ˜¯å¦å¼€å¯ netstat -lntup|grep 80 webæœåŠ¡å™¨ï¼šè®©ç”¨æˆ·è®¿é—®éœ€è¦å…¬ç½‘IPåœ°å€ï¼ŒåŸŸåè§£æï¼Œå½“è®¿é—®ç½‘ç«™çš„ç”¨æˆ·è¾ƒå¤šï¼ŒåŒæ—¶å†™å…¥å¢å¤šæ¶ˆè€—IOï¼ŒæœåŠ¡å™¨ç£ç›˜å‹åŠ›ï¼Œä¸ºäº†ç¼“è§£å‹åŠ›ï¼Œç”¨æˆ·åœ¨ç½‘ç«™çš„æ³¨å†Œç­‰æŸäº›å­—ç¬¦ä¸²ä¿¡æ¯ï¼Œé‚£å°±å­˜å‚¨åˆ°æ•°æ®åº“æœåŠ¡å™¨ï¼Œå›¾ç‰‡è§†é¢‘é™„ä»¶ç­‰å­˜å‚¨åœ¨å­˜å‚¨æœåŠ¡å™¨ï¼Œä¸å¤Ÿç”¨æ˜¯ä¹Ÿå¯ä»¥é…ç½®å¤šå°æœåŠ¡å™¨ éšç€ç”¨æˆ·ä½¿ç”¨çš„å¢å¤šï¼Œæ•°æ®åº“ï¼Œå­˜å‚¨æœåŠ¡å™¨å¯èƒ½æŸåï¼Œå°±è¦æœ‰ä¸€ä¸ªå¤‡ä»½æœåŠ¡å™¨ï¼Œå°†æ•°æ®åº“åŠå­˜å‚¨æœåŠ¡å™¨ä¸­çš„æ•°æ®å®šæ—¶å¤‡ä»½åˆ°å¤‡ä»½æœåŠ¡å™¨ä¸­ï¼Œä¸ºäº†é˜²æ­¢å¤‡ä»½æœåŠ¡å™¨æŸåï¼Œè¦è€ƒè™‘å¤šå°å¤‡ä»½æœåŠ¡å™¨ï¼Œå°½é‡ä¸è¦æŠŠå¤‡ä»½æœåŠ¡å™¨æœåŠ¡å™¨æ”¾åœ¨åŒä¸€ä¸ªåœ°æ–¹ï¼Œç”¨æˆ·ä¸æ–­å¢åŠ ï¼Œä¸€ä¸ªwebæœåŠ¡å™¨æ˜æ˜¾ä¸å¤Ÿï¼Œå°±è¦å¢åŠ å¤šå°webæœåŠ¡å™¨ï¼Œå‡ç¼“ç¬¬ä¸€å°webæœåŠ¡å™¨çš„å‹åŠ›ã€‚ ä¸ºäº†é˜²æ­¢é»‘å®¢éæ³•å…¥ä¾µï¼Œé…ç½®é˜²ç«å¢™æœåŠ¡ æ‰€ä»¥è¿™ä¸ªå°å‹æ¶æ„ç”¨æˆ·è®¿é—®æ—¶å…ˆè®¿é—®åˆ°é˜²ç«å¢™ï¼Œå†åˆ°è´Ÿè½½å‡è¡¡è®¾å¤‡ï¼Œå†åˆ°ç›¸åº”webæœåŠ¡å™¨ï¼Œæ ¹æ®å­˜å‚¨çš„å†…å®¹ï¼Œåœ¨åˆ†é…åˆ°æ•°æ®åº“æˆ–è€…å­˜å‚¨æœåŠ¡å™¨ï¼Œä¸ºäº†é˜²æ­¢è´Ÿè½½å‡è¡¡è®¾å¤‡å‡ºé—®é¢˜ä¹Ÿå¯ä»¥é…ç½®å¤šå°ï¼Œå«é«˜å¯ç”¨æ¶æ„ã€‚ç”¨æˆ·å…ˆè®¿é—®ä¸€å°ï¼Œä¸€å°å‡ºé—®é¢˜äº†å†è®¿é—®ç¬¬äºŒå°ï¼Œé¦–å…ˆè®¿é—®çš„å«ä¸»æœåŠ¡å™¨ï¼Œç¬¬äºŒå°å«å¤‡æœåŠ¡å™¨ ç”¨æˆ·è®¿é—®ç½‘ç«™ä¸€èˆ¬æµè§ˆç½‘ç«™æ¯”å†™å…¥æ•°æ®åˆ°ç½‘ç«™çš„è¡Œä¸ºæ›´å¤šï¼Œä¸ºäº†è®©ç”¨æˆ·è¯»çš„æ›´å¿«ï¼ŒåŠ é€Ÿè¯»å–æ•°æ®ï¼Œé…ç½®ç¼“å­˜æœåŠ¡å™¨ï¼Œå°†ç£ç›˜é‡ç‚¹ï¼Œçƒ­ç‚¹æ•°æ®å­˜å‚¨åˆ°ç¼“å­˜æœåŠ¡å™¨ï¼Œå†å­˜å‚¨åˆ°å†…å­˜ä¸­ï¼Œç”¨æˆ·å°±å¯ä»¥ä»ç¼“å­˜æœåŠ¡å™¨è¯»å–æ•°æ®ï¼Œå†™å…¥ä¹Ÿå¯ä»¥ï¼Œå¦‚æœè¯»å–çš„æ•°æ®æ²¡æœ‰ï¼Œå†æ ¹æ®è®¿é—®çš„å†…å®¹è®¿é—®æ•°æ®åº“æœåŠ¡å™¨æˆ–è€…å­˜å‚¨æœåŠ¡å™¨ï¼Œç¼“å­˜ä¹Ÿå¯ä»¥å¤šå°ã€‚ æ•°æ®åˆ†ææœåŠ¡å™¨å¯ä»¥æŠŠå­˜å‚¨çš„æ•°æ®è°ƒå–è¿‡æ¥åˆ†æï¼Œä¹Ÿå¯ä»¥åˆ†ææ—¥å¿—ï¼Œä¹Ÿæ˜¯åˆ†ä¸ºä¸ªå°å‹æ¶æ„ï¼Œå«æ¶ˆæ¯é˜Ÿåˆ—ç»“æ„ï¼Œå‰ç«¯æ”¶é›†æ•°æ®ï¼Œåç«¯è¿›è¡Œæ•°æ®åˆ†æï¼Œå°†ç»“æœä»¥å›¾å½¢çš„æ–¹å¼å±•ç¤ºå‡ºæ¥ï¼Œç”¨awkæˆ–è€…ELKè¿›è¡Œæ•°æ®åˆ†æ å·²ç»éƒ¨ç½²äº†å¾ˆå¤šè®¾å¤‡ï¼Œä¸ºäº†å®ç°å¯¹æ¶æ„æ›´å¥½çš„ç®¡ç†ï¼Œå¯ä»¥é…ç½®ç›‘æ§æœåŠ¡å™¨ï¼Œå¦‚æœæœ‰å…¶ä»–å¤šä¸ªæœºæˆ¿ä¹Ÿå¯ä»¥é…ç½®å¤šä¸ªç›‘æ§æœåŠ¡å™¨ï¼Œå«ä»£ç†ç›‘æ§æœåŠ¡å™¨ï¼Œä¸€ä¸ªä¸»çš„ç›‘æ§æœåŠ¡å™¨ï¼Œmasterè¡¨ç¤ºï¼Œè¿™æ ·å¯ä»¥å¯¹æ‰€æœ‰ä¼ä¸šé‡Œçš„æœåŠ¡å™¨åšç›‘æ§ç®¡ç†ã€‚ ç»“æ„çš„æœåŠ¡å™¨è®¾å¤‡å¤ªå¤šï¼Œéœ€è¦ç®¡ç†è¿™ä¸€å †æ¶æ„ï¼Œå®ç°éƒ¨ç½²é…ç½®éœ€è¦ï¼Œåœ¨é…ç½®ä¸€ä¸ªæ‰¹é‡ç®¡ç†æœåŠ¡å™¨ï¼Œè·Ÿæ¯å°æœåŠ¡å™¨å»ºç«‹è”ç³»ã€‚ å¯¹äºç”¨æˆ·çš„è®¿é—®æ¸ é“æœ‰äº†ï¼Œå¯¹äºè¿ç»´äººå‘˜ï¼Œèµ°å¦ä¸€æ¡è·¯ï¼Œä¸ºäº†ä¿è¯å®‰å…¨æ€§ï¼Œé…ç½®VPNæœåŠ¡å™¨ï¼Œè®©åªæœ‰å†…éƒ¨çš„äººå¯ä»¥è¿æ¥è¿›å…¥ï¼Œç±»ä¼¼äºä¸€ä¸ªç‰¹æ®Šé€šé“ï¼Œéœ€è¦ç”¨æˆ·åå¯†ç éªŒè¯ï¼Œé€šè¿‡åå°±å¯ä»¥è¿æ¥è®¿é—®ç®¡ç†ä»»æ„ä¸€å°æœåŠ¡å™¨ã€‚ ä¸ºäº†é˜²æ­¢å†…éƒ¨äººå‘˜åšå‡ºç ´åæ€§è¡Œä¸ºï¼Œä¸ºå†…éƒ¨äººå‘˜è®¿é—®åšå‡ºç›‘ç®¡ï¼Œé…ç½®è·³æ¿æœºæœåŠ¡å™¨ï¼ŒVPNï¼Œè·³æ¿æœºï¼Œæ‰¹é‡ç®¡ç†ï¼Œç›‘æ§ç­‰æœåŠ¡å™¨å«åšç½‘ç«™è¿ç»´äººå‘˜ç®¡ç†ç½‘ç«™çš„æ¶æ„ï¼Œé€šè¿‡è¿™ä¸ªæ¶æ„ï¼Œå¯ä»¥æ›´å¥½åœ°æ–¹ä¾¿å¯¹ç½‘ç«™åºå¤§çš„æœåŠ¡å™¨ç›‘æ§ç®¡ç†ï¼Œä»¥åŠå‡ºç°é—®é¢˜äº†å¯ä»¥è®°å½•ç”¨æˆ·çš„æ“ä½œè¡Œä¸ºã€‚ä»¥ä¸Šå°±å®Œæˆäº†ä¸€ä¸ªä¸­å°è§„æ¨¡çš„å®Œæ•´ä¼ä¸šæ¶æ„ã€‚ 2ã€ç»¼åˆæ¶æ„è§„åˆ’ ä¸»æœºåç§° IPåœ°å€è§„åˆ’ éœ€è¦çš„è½¯ä»¶ é˜²ç«å¢™æœåŠ¡å™¨ï¼ˆfirewalld) 10.0.0.81ï¼ˆå¤–ç½‘ï¼‰ 172.16.1.81(å†…ç½‘) è´Ÿè½½å‡è¡¡æœåŠ¡å™¨ï¼ˆlb01ï¼‰ 10.0.0.5 (å¤–ç½‘) 172.16.1.5ï¼ˆå†…ç½‘ï¼‰ nginx keepalived è´Ÿè½½å‡è¡¡æœåŠ¡å™¨ï¼ˆlb02ï¼‰ 10.0.0.6 (å¤–ç½‘) 172.16.1.6ï¼ˆå†…ç½‘ï¼‰ nginx keepalived webæœåŠ¡å™¨ï¼ˆweb01) 10.0.0.7 (å¤–ç½‘) 172.16.1.7 (å†…ç½‘) nginx webæœåŠ¡å™¨ï¼ˆweb02) 10.0.0.8 (å¤–ç½‘) 172.16.1.8 (å†…ç½‘) nginx webæœåŠ¡å™¨ï¼ˆweb03) 10.0.0.9 (å¤–ç½‘) 172.16.1.9 (å†…ç½‘) nginx æ•°æ®åº“ï¼ˆdb01) 10.0.0.51(å¤–ç½‘) 172.16.1.51ï¼ˆå†…ç½‘ï¼‰ MySQL å­˜å‚¨æœåŠ¡å™¨ï¼ˆnfs01ï¼‰ 10.0.0.31(å¤–ç½‘) 172.16.1.31ï¼ˆå†…ç½‘ï¼‰ nfs å¤‡ä»½æœåŠ¡å™¨ï¼ˆbackupï¼‰ 10.0.0.41ï¼ˆå¤–ç½‘ï¼‰ 172.16.1.41ï¼ˆå†…ç½‘ï¼‰ rsync æ‰¹é‡ç®¡ç†æœåŠ¡å™¨ï¼ˆm01ï¼‰ 10.0.0.61(å¤–ç½‘) 172.16.1.61ï¼ˆå†…ç½‘ï¼‰ ansible è·³æ¿æœºæœåŠ¡å™¨ï¼ˆjumpserverï¼‰ 10.0.0.71(å¤–ç½‘) 172.16.1.71ï¼ˆå†…ç½‘ï¼‰ jumpserver ç›‘æ§æœåŠ¡å™¨ï¼ˆzabbixï¼‰ 10.0.0.72(å¤–ç½‘) 172.16.1.72ï¼ˆå†…ç½‘ï¼‰ zabbix ç”±äºèµ„æºæœ‰é™ï¼Œåªèƒ½ç”¨è™šæ‹Ÿæœºè¿›è¡Œæ¨¡æ‹Ÿæµ‹è¯• 1ã€ä¼˜åŒ–é…ç½®æ¨¡æ¿ä¸»æœºè¿›è¡Œç½‘å¡é…ç½® ä¹‹å‰æ¨¡æ¿ä¸»æœºç¬¬ä¸€å¼ ç½‘å¡IPåœ°å€ä¸º10.0.0.200 æ‰€ä»¥åœ¨æ·»åŠ ä¸€å¼ ç½‘å¡ï¼ŒIPåœ°å€ä¸º171.16.1.200 aã€æ·»åŠ ç½‘å¡ bã€é…ç½®ç½‘å¡ vim /etc/sysconfig/network-scripts/ifcfg-eth1 æˆ–è€…è¾“å…¥ nmtui å›¾å½¢åŒ–ç•Œé¢é…ç½®ç½‘å¡ 2ã€ç³»ç»Ÿä¼˜åŒ–è¿‡ç¨‹1ï¼‰æ¨¡æ¿æœºä¼˜åŒ–é…ç½®â€”â€”hosts æ–‡ä»¶é…ç½®å…ˆå¤‡ä»½ä¸€ä¸‹hostsæ–‡ä»¶ \\cp /etc/hosts&#123;.bak&#125; cat &gt;/etc/hosts&lt;&lt;EOF 127.0.0.1 localhost localhost.localdomain localhost4 localhost4.localdomain4 ::1 localhost localhost.localdomain localhost6 localhost6.localdomain6172.16.1.5 lb01 172.16.1.6 lb02 172.16.1.7 web01 172.16.1.8 web02 172.16.1.9 web03 172.16.1.51 db01 db01.etiantian.org 172.16.1.31 nfs01 172.16.1.41 backup 172.16.1.61 m01 172.16.1.71 jumpserver 172.16.1.72 zabbixEOF 2ï¼‰æ¨¡æ¿æœºä¼˜åŒ–é…ç½®â€”â€”è·Ÿæ–°yumæºæ›´æ”¹yumæº mv /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.backup &amp;&amp;\\ curl -o /etc/yum.repos.d/CentOS-Base.repo https://mirrors.aliyun.com/repo/Centos-7.repo yum install -y wget wget -O /etc/yum.repos.d/epel.repo http://mirrors.aliyun.com/repo/epel-7.repo 3ï¼‰æ¨¡æ¿æœºä¼˜åŒ–é…ç½®â€”â€”å…³é—­selinuxsed -i.bak &#39;s/SELINUX=enforcing/SELINUX=disabled/&#39; /etc/selinux/config grep SELINUX=disabled /etc/selinux/config 4) æ¨¡æ¿æœºä¼˜åŒ–é…ç½®â€”â€”å…³é—­iptablessystemctl stop firewalld systemctl disable firewalld systemctl ststus firewalld 5) æ¨¡æ¿æœºä¼˜åŒ–é…ç½®â€”â€”æ™®é€šç”¨æˆ·oldboyå¯ä»¥ä½¿ç”¨sudouseradd oldboy echo 123456|passwd --stain oldboy echo &quot;oldboy ALL=(ALL) NOPASSWD: ALL &quot;&gt;&gt;/etc/sudoers tail -1 /etc/sudoers visudo -c 6) æ¨¡æ¿æœºä¼˜åŒ–é…ç½®â€”â€”è‹±æ–‡å­—ç¬¦é›†å…ˆæŸ¥çœ‹ä¸€ä¸‹ echo $LANG ä¿®æ”¹ localectl set-locale LANG=&quot;en_US.UTF-8&quot; é‡å¯ reboot echo $LANG 7) æ¨¡æ¿æœºä¼˜åŒ–é…ç½®â€”â€”æ—¶é—´åŒæ­¥ä¸‹è½½è½¯ä»¶ yum install -y ntpdate echo &#39;#time sync by lidao at 2020-12-03&#39; &gt;&gt;/var/spool/cron/root æ·»åŠ æ³¨é‡Š echo &#39;*/5 * * * * /usr/sbin/ntpdate ntp1.aliyun.com &gt;/dev/null 2&gt;&amp;1&#39; &gt;&gt;/var/spool/cron/root æ¯éš”äº”åˆ†é’ŸåŒæ­¥ä¸€æ¬¡ crontab -l æŸ¥çœ‹ 8) æ¨¡æ¿æœºä¼˜åŒ–é…ç½®â€”â€”åŠ å¤§æ–‡ä»¶æè¿°yum install -y lsoflsof -i:22 echo &#39;* - nofile 1024&#39; &gt;&gt;/etc/security/limits.conf source /etc/security/limits.conf è¯´æ˜ï¼šä¸€ä¸ªæœåŠ¡è¿›ç¨‹è¿è¡Œèµ·æ¥ï¼Œä¼šæ‰“å¼€ç›¸åº”çš„æ–‡ä»¶ 9) æ¨¡æ¿æœºä¼˜åŒ–é…ç½®â€”â€”å®‰è£…å…¶ä»–å°è½¯ä»¶yum install lrzsz nmap tree dos2unix nc telnet bash-completion bash-completion-extras -y å½“ç„¶ä»¥ä¸Šå‘½ä»¤ï¼Œä¹Ÿå¯ä»¥å†™æˆä¸€ä¸ªè„šæœ¬ï¼Œæ–¹æ³•æœ‰å¾ˆå¤šï¼Œè¿™é‡Œå°±ä¸ä»‹ç»äº†ï¼Œå¯è‡ªè¡Œç™¾åº¦ã€‚","categories":[],"tags":[{"name":"ç»¼åˆæ¶æ„","slug":"ç»¼åˆæ¶æ„","permalink":"https://blog-wangyong.xyz/tags/%E7%BB%BC%E5%90%88%E6%9E%B6%E6%9E%84/"}]},{"title":"ansible","slug":"ansible","date":"2020-12-28T12:05:59.000Z","updated":"2020-12-28T13:14:58.633Z","comments":true,"path":"article/c5cc7aa1.html","link":"","permalink":"https://blog-wangyong.xyz/article/c5cc7aa1.html","excerpt":"","text":"","categories":[],"tags":[]},{"title":"TCPåè®®çš„ä¸‰æ¬¡æ¡æ‰‹å’Œå››æ¬¡æŒ¥æ‰‹","slug":"TCPåè®®çš„ä¸‰æ¬¡æ¡æ‰‹å’Œå››æ¬¡æŒ¥æ‰‹","date":"2020-12-27T14:42:06.160Z","updated":"2021-01-12T14:06:45.166Z","comments":true,"path":"article/109c512.html","link":"","permalink":"https://blog-wangyong.xyz/article/109c512.html","excerpt":"","text":"1ã€TCPåè®®æ˜¯ä»€ä¹ˆï¼Ÿ ä¼ è¾“æ§åˆ¶åè®®ï¼ˆTransmission Control Protocolï¼ŒTCPï¼‰æ˜¯ä¸€ç§é¢å‘è¿æ¥çš„ã€å¯é çš„ã€åŸºäºå­—èŠ‚æµçš„ä¼ è¾“å±‚é€šä¿¡åè®®ã€‚åœ¨ TCP åè®®ä¸­ï¼Œé€šè¿‡ä¸‰æ¬¡æ¡æ‰‹å»ºç«‹è¿æ¥ã€‚é€šä¿¡ç»“æŸåï¼Œè¿˜éœ€è¦æ–­å¼€è¿æ¥ã€‚å¦‚æœåœ¨å‘é€æ•°æ®åŒ…æ—¶ï¼Œæ²¡æœ‰æ­£ç¡®è¢«å‘é€åˆ°ç›®çš„åœ°æ—¶ï¼Œå°†ä¼šé‡æ–°å‘é€æ•°æ®åŒ…ã€‚ 2ã€TCPçš„å·¥ä½œæ¨¡å¼ï¼Ÿ TCP åè®®çš„æ•°æ®åŒ…è¿›è¡Œä¼ è¾“é‡‡ç”¨çš„æ˜¯æœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯æ¨¡å¼ã€‚å‘é€ TCP æ•°æ®è¯·æ±‚æ–¹ä¸ºå®¢æˆ·ç«¯ï¼Œå¦ä¸€æ–¹åˆ™ä¸ºæœåŠ¡å™¨ç«¯ã€‚å®¢æˆ·ç«¯è¦ä¸æœåŠ¡å™¨ç«¯è¿›è¡Œé€šä¿¡ï¼ŒæœåŠ¡å™¨ç«¯å¿…é¡»å¼€å¯ç›‘å¬çš„ç«¯å£ï¼Œå®¢æˆ·ç«¯æ‰èƒ½é€šè¿‡ç«¯å£è¿æ¥åˆ°æœåŠ¡å™¨ï¼Œç„¶åè¿›è¡Œé€šä¿¡ã€‚ 3ã€TCPçš„ä¸‰æ¬¡æ¡æ‰‹ ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼š å‘é€synè¯·æ±‚å»ºç«‹è¿æ¥å­—æ®µï¼Œå‘é€seqåºåˆ—å·ä¿¡æ¯ï¼Œç¬¬ä¸€ä¸ªæ•°æ®åŒ…çš„åºåˆ—å·é»˜è®¤ä¸ºï¼ˆXï¼‰ ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼š å‘é€synè¯·æ±‚å»ºç«‹è¿æ¥å­—æ®µï¼ŒåŒæ—¶å‘é€ackç¡®è®¤æ§åˆ¶å­—æ®µï¼Œå‘é€seqåºåˆ—å·ä¿¡æ¯ä¸ºï¼ˆYï¼‰ï¼Œè¿˜ä¼šå‘é€ackç¡®è®¤å·ï¼ˆX+1ï¼‰ä¿¡æ¯ï¼ˆå¯¹ä¸Šä¸€ä¸ªæ•°æ®åˆ—å·ä¿¡æ¯è¿›è¡Œç¡®è®¤ï¼‰ ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼š å‘é€ackç¡®è®¤æ§åˆ¶å­—æ®µï¼Œå‘é€seqåºåˆ—å·ä¿¡æ¯ï¼ˆX+1ï¼‰ï¼Œå‘é€ackç¡®è®¤å·ï¼ˆX+1ï¼‰ 4ã€TCPçš„å››æ¬¡æŒ¥æ‰‹è¿‡ç¨‹ ç¬¬ä¸€æ¬¡æŒ¥æ‰‹ï¼š å‘é€finè¯·æ±‚æ–­å¼€è¿æ¥æ§åˆ¶å­—æ®µ ç¬¬äºŒæ¬¡æŒ¥æ‰‹ï¼š å‘é€ackç¡®è®¤æ§åˆ¶å­—æ®µ ç¬¬ä¸‰æ¬¡æŒ¥æ‰‹ï¼š å‘é€finè¯·æ±‚æ–­å¼€è¿æ¥å­—æ®µï¼Œå‘é€ackç¡®è®¤å­—æ®µ ç¬¬å››æ¬¡æŒ¥æ‰‹ï¼š å‘é€ackæ§åˆ¶å­—æ®µï¼Œæ–­å¼€è¿æ¥","categories":[],"tags":[{"name":"ç½‘ç»œ","slug":"ç½‘ç»œ","permalink":"https://blog-wangyong.xyz/tags/%E7%BD%91%E7%BB%9C/"}]},{"title":"Hello World","slug":"hello-world","date":"2020-12-20T13:53:21.248Z","updated":"2020-12-29T04:33:24.214Z","comments":true,"path":"article/16107.html","link":"","permalink":"https://blog-wangyong.xyz/article/16107.html","excerpt":"","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post$ hexo new &quot;My New Post&quot; More info: Writing Run server$ hexo server More info: Server Generate static files$ hexo generate More info: Generating Deploy to remote sites$ hexo deploy More info: Deployment","categories":[],"tags":[{"name":"Hello World","slug":"Hello-World","permalink":"https://blog-wangyong.xyz/tags/Hello-World/"}]}],"categories":[{"name":"ä¸ªäºº","slug":"ä¸ªäºº","permalink":"https://blog-wangyong.xyz/categories/%E4%B8%AA%E4%BA%BA/"}],"tags":[{"name":"çŸ¥è¯†ç‚¹","slug":"çŸ¥è¯†ç‚¹","permalink":"https://blog-wangyong.xyz/tags/%E7%9F%A5%E8%AF%86%E7%82%B9/"},{"name":"ç»¼åˆæ¶æ„","slug":"ç»¼åˆæ¶æ„","permalink":"https://blog-wangyong.xyz/tags/%E7%BB%BC%E5%90%88%E6%9E%B6%E6%9E%84/"},{"name":"ä¼ä¸šä¸­çš„åº”ç”¨","slug":"ä¼ä¸šä¸­çš„åº”ç”¨","permalink":"https://blog-wangyong.xyz/tags/%E4%BC%81%E4%B8%9A%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/"},{"name":"ç½‘ç»œ","slug":"ç½‘ç»œ","permalink":"https://blog-wangyong.xyz/tags/%E7%BD%91%E7%BB%9C/"},{"name":"Hello World","slug":"Hello-World","permalink":"https://blog-wangyong.xyz/tags/Hello-World/"}]}